---
title: "Analysis"
author: "Soo Wan Kim"
date: "April 28, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

##################
# Correct answers #
##################

proportions <- data.frame(matrix(ncol = 2, nrow = 0))
colnames(proportions) <- c("question_id", "prop")

files <- list.files("Experimental Design/Proportions Data")
path_root <- "Experimental Design/Proportions Data/"

import_select <- function(file) {
  path <- paste0(path_root, file)
  data <- read_csv(path)
  data <- dplyr::filter(data, !is.na(dot))
  data <- data[,2]
  
  question_id <- as.numeric(unlist(regmatches(path, gregexpr("[0-9]", path))))
  prop <- min(data)/max(data) * 100
  
  prop_data <- as.data.frame(t(as.data.frame(c(question_id, prop))))
  rownames(prop_data) <- NULL
  colnames(prop_data) <- c("question_id", "prop")
  
  return(prop_data)
}

for (i in seq_along(files)) {
  prop <- import_select(files[i])
  proportions <- rbind(proportions, prop)
}

###################
# Tidy Test Data  #
###################

treatment1 <- read_csv("Test Data/Treatment 1 - Black and White.csv") %>%
  filter(Status == "IP Address", Finished == "TRUE")

names(treatment1)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
