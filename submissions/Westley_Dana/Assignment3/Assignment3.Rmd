---
title: "Assignment 3"
author: "Dana Westley"
date: "Due May 10, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include=FALSE}
library(maps)
library(ggplot2)
library(tibble)
library(dplyr)

#GDP, School Gender Ratio, and Fertility by Country
data = read.csv("~/Desktop/Data Visualization/DataViz/submissions/Westley_Dana/Assignment3/MasterGapminder.csv")

map("world")
world <- map_data("world") %>%
  as_tibble

library(RColorBrewer)
g2 <- ggplot(data, aes(map_id = Country)) +
  geom_map(aes(fill = TotalFert2015), map = world) +
  expand_limits(x = world$long, y = world$lat) + 
  labs(title = "2015 World Fertility", x = "", y = "")+ 
  scale_fill_gradient(low = "indianred1", high = "firebrick4", name = "Avg. No. of Children") + 
  theme(plot.title = element_text(hjust = 0.5, size = 20)) + 
  ylim(-75,100)
print(g2)
#Some countries missing
#needed to relabel Ivory Coast, USA, Republic of Congo, Democratic Republic of the Congo, Macedonia, Slovakia, Laos, South Sudan



#New Data File only with Fertility Info By Year and Country
fert <- read.csv("~/Desktop/Data Visualization/DataViz/submissions/Westley_Dana/Assignment3/FertilityHistory2.csv", check.names = FALSE)

library(reshape2)
fertmelt <- melt(fert, "Country", variable.name = "Year", value.name = "Fertility")

g3 <- ggplot(fertmelt, aes(map_id = Country)) +
  geom_map(aes(fill = Fertility), map = world) +
  expand_limits(x = world$long, y = world$lat)

print(g3)

```

#Interactive Visual
```{r}
#plotly
library(plotly)
ggplotly(g2)

#ggploty keeps crashing my R, "Subscript out of bounds"

```
#The Story

